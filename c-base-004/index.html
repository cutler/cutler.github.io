<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="http://www.gov.cn/" title="不只是看客" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="概述　　数据管理的三个阶段 　　人工管理阶段：此阶段程序员的源代码都写在卡片上（程序处理的数据也完全与程序写在一起），执行程序时将卡片送进计算机，计算机运算完毕后，将结果返回给程序员。程序执行期间，程序员不能和计算机交互，也没有磁盘的概念，数据根本没法共享，依赖于程序存在。  硬件：无磁盘，数据无法长期存储。软件：无操作系统和DBMS。数据处理方式：批处理，中途无交互。特点：数据不共享，不具有独立">
<meta property="og:type" content="article">
<meta property="og:title" content="第四章 数据库">
<meta property="og:url" content="http://yoursite.com/c-base-004/index.html">
<meta property="og:site_name" content="不只是看客">
<meta property="og:description" content="概述　　数据管理的三个阶段 　　人工管理阶段：此阶段程序员的源代码都写在卡片上（程序处理的数据也完全与程序写在一起），执行程序时将卡片送进计算机，计算机运算完毕后，将结果返回给程序员。程序执行期间，程序员不能和计算机交互，也没有磁盘的概念，数据根本没法共享，依赖于程序存在。  硬件：无磁盘，数据无法长期存储。软件：无操作系统和DBMS。数据处理方式：批处理，中途无交互。特点：数据不共享，不具有独立">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://yoursite.com/img/base/base003_01.png">
<meta property="og:image" content="http://yoursite.com/img/base/base003_02.png">
<meta property="og:image" content="http://yoursite.com/img/base/base003_03.png">
<meta property="og:image" content="http://yoursite.com/img/base/base003_04.png">
<meta property="og:updated_time" content="2022-10-28T10:49:35.626Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="第四章 数据库">
<meta name="twitter:description" content="概述　　数据管理的三个阶段 　　人工管理阶段：此阶段程序员的源代码都写在卡片上（程序处理的数据也完全与程序写在一起），执行程序时将卡片送进计算机，计算机运算完毕后，将结果返回给程序员。程序执行期间，程序员不能和计算机交互，也没有磁盘的概念，数据根本没法共享，依赖于程序存在。  硬件：无磁盘，数据无法长期存储。软件：无操作系统和DBMS。数据处理方式：批处理，中途无交互。特点：数据不共享，不具有独立">
<meta name="twitter:image" content="http://yoursite.com/img/base/base003_01.png">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://yoursite.com/c-base-004/"/>

  <title> 第四章 数据库 | 不只是看客 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?53b4b0b5aeb5df5e4fb6263a58d8e1a9";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">不只是看客</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-feedback">
          <a href="/feedback" rel="section">
            
            留言
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404.html" rel="section">
            
            公益404
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                第四章 数据库
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2010-11-08T09:33:49+08:00" content="2010-11-08">
              2010-11-08
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                    <span itemprop="name">计算机基础</span>
                </span>

                
                

              
            </span>
          

          

          
          
             <span id="/c-base-004/" class="leancloud_visitors" data-flag-title="第四章 数据库">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><p><br>　　<strong>数据管理的三个阶段</strong></p>
<p>　　<font color="red">人工管理阶段</font>：此阶段程序员的源代码都写在卡片上（程序处理的数据也完全与程序写在一起），执行程序时将卡片送进计算机，计算机运算完毕后，将结果返回给程序员。程序执行期间，程序员不能和计算机交互，也没有磁盘的概念，数据根本没法共享，依赖于程序存在。</p>
<blockquote>
<p>硬件：无磁盘，数据无法长期存储。<br>软件：无操作系统和DBMS。<br>数据处理方式：批处理，中途无交互。<br>特点：数据不共享，不具有独立性</p>
</blockquote>
<p>　　<font color="red">文件系统阶段</font>：此阶段出现了OS（操作系统）、文件系统(文件系统是OS的一个子系统)出现。此时应用程序通过OS来访问磁盘中被文件系统中管理的文件，但是此阶段是<font color="red">数据本身内有数据结构，整体无结构</font>，即数据只能以单个文件的形式存储，当程序要查找某一个数据时，从文件头到文件尾顺序查找，查找的速度十分慢，而且数据中重复多，数据只能进行简单的共享。</p>
<blockquote>
<p>硬件：有磁盘，数据可以长期存储，有了文件的概念。<br>软件：有操作系统和专门的DBMS<br>数据处理方式： 批处理、实时处理。<br>特点：数据冗余大、共享性差。</p>
</blockquote>
<p>　　另外，所谓的数据本身内有数据结构整体无结构是指：</p>
<blockquote>
<p>比如数据中有一个学生对象，这个学生对象包括：姓名、学号、性别等字段，这就叫数据内有结构。但是多个对象之间是顺序排放的，查找的时候需要从头到尾的查找速度很慢，这叫数据整体无结构。</p>
</blockquote>
<p>　　<font color="red">数据库系统阶段</font>：此阶段数据整体就有结构的了，这一时期是直接通过DBMS来管理数据，而不再是通过OS的文件系统来间接管理数据了，因此此时对数据的检索和更新是非常快的。</p>
<blockquote>
<p>硬件：磁盘容量增加，价格下降。<br>软件：DBMS功能丰富，成本上涨。<br>数据处理方式：实时处理、批处理、分布式处理(数据分布在多个物理位置上)。<br>特点：数据共享性高、独立性强、数据结构化。</p>
</blockquote>
<p><br>　　<strong>DBMS</strong></p>
<p>　　数据库管理系统(Database Management System)，我们常见的<code>Oracle</code>、<code>SQL Server2005</code>、<code>db2</code>、<code>My SQL</code>等软件都是DBMS。<br>　　以下是DBMS的功能：</p>
<blockquote>
<p>数据定义：建立表、视图、索引、定义数据库体系结构等。<br>数据操作：检索(就是查找)和更新。<br>DB的备份和恢复。<br>数据库的维护功能： 数据载入、转存、转储以及DB的改组和性能的监控等。<br>数据库的并发控制：在多个用户同时处理一个数据时，应避免破坏数据，通常使用挂起。比如在数据库中，用户A对数据进行修改后，可以选择“提交”或者“回滚”，但是在他未通过命令进行“提交”或“回滚”之前，B用户此时也请求修改这个数据，则B用户会被挂起，只有等A提交或者回滚后，B才能修改这个数据。说白了就是DBMS可以保证一个数据，在同一时间只能被一个用户操作。</p>
</blockquote>
<p>　　常见DBMS的分类：</p>
<blockquote>
<p>小型数据库：  foxbase和 微软的 Access<br>中型数据库：  Mysql  和 微软的SQL Server2005 以及IBM的infomix<br>大型数据库：  Sybase 、oracle和 IBM的db2</p>
</blockquote>
<p><br>　　<strong>SQL</strong></p>
<p>　　<code>SQL（Structured  Query  Language 结构化查询语言）</code>常用于与数据库的通讯，它是非过程式(用户通过输入命令即可得到结果，命令的具体执行不用咱们关心)的程序设计语言，非过程式语言也被称为“<font color="red">第四代语言</font>”。</p>
<blockquote>
<p>ANSI(美国国家标准协会) 声称：“SQL是关系数据库管理系统的标准语言”，也就是说使用SQL语言在各大关系型数据库中都可以进行基本的操作。<br>SQL于1974年提出，它有三个标准：<br>　　第一个 ：ANSI SQL 。<br>　　第二个 ：1992年对SQL进行修改，得到SQL92(又称SQL2)。<br>　　第三个 ：最近的SQL99标准也称为是“SQL3”。<br>每个数据库也都会扩展SQL语句，即在SQL标准的基础上增加一些只有其自身才能识别的SQL专用的命令。</p>
</blockquote>
<h1 id="Oracle数据库"><a href="#Oracle数据库" class="headerlink" title="Oracle数据库"></a>Oracle数据库</h1><p>　　<code>Oracle</code>数据库由美国的<code>Oracle</code>公司生产的，<code>Oracle</code>原本的含义是“<font color="red">神谕</font>”，指的是神说的话，在中国的商代，人们把一些刻在龟壳上的文字当成是上天的指示，所以在中国将<code>Oracle</code>也译成“<font color="red">甲骨文</font>”，目前Oracle公司已经收购了SUN公司。</p>
<h2 id="数据查询"><a href="#数据查询" class="headerlink" title="数据查询"></a>数据查询</h2><h3 id="简单查询"><a href="#简单查询" class="headerlink" title="简单查询"></a>简单查询</h3><p>　　从本节开始，所有介绍的SQL语句都是基于如下两张表的。</p>
<center><br><img src="/img/base/base003_01.png" alt=""><br></center>

<p><br>　　范例1：基本查询语句。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> empno,ename,job,hiredate,mgr,sal,comm,deptno </span><br><span class="line"><span class="keyword">FROM</span>  emp;</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  SELECT关键字指出您要选择表中的哪些列，如果要选择多个列，则列间用逗号间隔，若想选择表中的所有列，则使用“*”代替。 
-  SQL语句执行过程：数据库先执行FROM找到emp表，因为上面没有限制选择表中的哪些行，所以默认选择所有行，接着执行SELECT，从被选择的行中抽出SELECT语句后面指定的那些列，然后输出。
-  注意SQL语句必须以分号(;)结尾。
</code></pre><p><br>　　范例2：四则运算。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ename,sal*<span class="number">12</span></span><br><span class="line"><span class="keyword">FROM</span> emp;</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  字段是可以进行四则运算的，先乘除，后加减，内层括号最优先。
</code></pre><p><br>　　范例3：别名。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> empno <span class="keyword">as</span> <span class="string">"编·号"</span>,ename <span class="string">"姓名"</span>,job 工作</span><br><span class="line"><span class="keyword">FROM</span> emp;</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  查询数据时，SELECT后面的列的列名称可以由用户自定义，自定义的名称被称为别名。别名有三种定义方式：
-  第一种：empno as &quot;编·号&quot;
-  第二种：empno &quot;编·号&quot;
-  第三种：empno 编号
-  当别名使用双引号包含时，可以在别名中包含空格或特殊的字符并区分大小写，若别名以数字开头，则必须使用双引号。若给表起了别名，则在当前SQL语句中，就不能再使用表的全名，而只能使用别名。
</code></pre><p><br>　　范例4：消除重复。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 使用distinct关键字可以消除job列的值重复的行</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">distinct</span> job</span><br><span class="line"><span class="keyword">FROM</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 若select查找多个列，则只有多个列同时相同时，distinct关键字才起作用。</span></span><br><span class="line"><span class="comment">-- 下面的语句此时只有在2个员工的姓名和工作两个列的值完全相同的情况下才会消除重复。</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">distinct</span> ename,job    </span><br><span class="line"><span class="keyword">FROM</span> emp;</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  在SQL中可以使用单行注释“--”和多行注释“/*  */”。
</code></pre><h3 id="限定查询"><a href="#限定查询" class="headerlink" title="限定查询"></a>限定查询</h3><p><br>　　范例1：限定查询(WHERE)。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询出编号为7934的员工的姓名、工作、工资。</span></span><br><span class="line"><span class="keyword">SELECT</span> empno,ename,job,sal</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="comment">-- 可以在WHERE子句中使用 is null、is not null 来判断当前列是否为空。</span></span><br><span class="line"><span class="keyword">Where</span> empno=<span class="number">7934</span>;</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  Where关键字就是用来指定选择某些行。
-  Where的工作原理：将表中的所有记录，依次拿到Where后的表达式中进行筛选，如果表达式返回true则选中这行，否则就不选。即先执行from，然后执行where，最后执行select。
</code></pre><p><br>　　范例2：运算符。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询出工资在2000-3000之间的员工的信息。</span></span><br><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> sal&gt;=<span class="number">2000</span> <span class="keyword">and</span> sal&lt;=<span class="number">3000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询出名为SCOTT的员工的信息。</span></span><br><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> ename = <span class="string">'SCOTT'</span>;</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  逻辑运算符：not 、and、or。
-  关系运算符：=、&gt;、&lt;、&gt;= 、&lt;= 、  !=和&lt;&gt;(这两个都是代表不等于) 。
</code></pre><p><br>　　范例3：Between子句。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询出工资 2000&lt;=x&lt;=3000 的所有员工。</span></span><br><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> sal <span class="keyword">between</span> <span class="number">2000</span> <span class="keyword">and</span> <span class="number">3000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 用between限制字符串。</span></span><br><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> ename <span class="keyword">between</span> <span class="string">'D'</span> <span class="keyword">and</span> <span class="string">'W'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 用between限制日期（关于使用between限制日期所用到的函数稍后叙述）。</span></span><br><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> hiredate <span class="keyword">between</span> <span class="keyword">to_date</span>(<span class="string">'1985-1-1'</span>,<span class="string">'yyyy-mm-dd'</span>) <span class="keyword">and</span></span><br><span class="line"> <span class="keyword">to_date</span>(<span class="string">'1990-1-1'</span>,<span class="string">'yyyy-mm-dd'</span>);</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  between子句一般用于限制数字的取值范围(当然限制字符串、日期也行)。
</code></pre><p><br>　　范例4：In子句。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询出工作为：Clerk和Manager的所有员工的信息。</span></span><br><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> job <span class="keyword">in</span>(‘CLERK’,’MANAGER’) ;</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  in又称为列表运算符，在in里面列出了job的所有取值，如果job的值等于in里面的任何一个值，则返回true，而返回true就意味着会被where选中。
</code></pre><p><br>　　范例5：Like子句。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询出姓名中第二个字符是A的员工的信息。</span></span><br><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> ename <span class="keyword">like</span><span class="string">'_A%'</span>;</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  Like子句又称为模糊匹配运算符，有两个通配符：“_”代表一位任意字符，“%”代表零位或多位任意字符。如果要查询出姓名中包括字母A的员工，可用‘%A%’来进行匹配。
-  在字符串中是区分大小写的，如果将’_A%’改成’_a%’则查询按a查而不是按A查。
</code></pre><p><br>　　范例6：排序输出(Order By子句)。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 将所有员工按工资从大到小排序</span></span><br><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> sal <span class="keyword">desc</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 按照列的别名排序</span></span><br><span class="line"><span class="keyword">SELECT</span> sal s</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> s <span class="keyword">desc</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 按列的下标排序</span></span><br><span class="line"><span class="comment">-- 由于选择了2列，所以取值范围是1~2 ，而2对应着sal字段。</span></span><br><span class="line"><span class="keyword">SELECT</span> ename e,sal s</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">2</span> <span class="keyword">desc</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 当工资相同时，则使姓名按降序排列，如果工资不相同，则不考虑第二个排序字段。</span></span><br><span class="line"><span class="keyword">SELECT</span> ename e,sal s</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">2</span> <span class="keyword">desc</span>,<span class="number">1</span> <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  使用Order by子句可以对查询出来的数据进行排序。
-  排序策略：asc(升序)、desc(降序)，若不指定排序策略，则默认按照asc排序。
-  Order by可以按照列名、别名、下标、表达式排序，而且Order by子句必需写在整个SQL语句的最后。     
</code></pre><h3 id="单行函数"><a href="#单行函数" class="headerlink" title="单行函数"></a>单行函数</h3><p><br>　　在数据库系统中，每个数据库之间最大区别就在与对函数的支持上，使用函数可以完成一系列的运算。函数分为：<font color="red">单行函数</font>和<font color="red">多行函数</font>。</p>
<blockquote>
<p>单行函数：接受一个参数，返回一个值。<br>多行函数：接受多个参数，返回一个值。<br>Oracle的单行函数主要分为：字符函数、数值函数、日期函数、转换函数、通用函数5种。</p>
</blockquote>
<p>　　字符函数，顾名思义，处理字符串的函数。</p>
<p><br>　　范例1：lower和upper函数。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 将所有员工的姓名转成小写的形式。</span></span><br><span class="line"><span class="keyword">SELECT</span> ename 原名, <span class="keyword">lower</span>(ename) 小写,<span class="keyword">upper</span>(ename) 大写,initcap(ename) 首字母大写</span><br><span class="line"><span class="keyword">FROM</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- lower(str) 将给定参数的每一个字符，依次转成小写形式，若某个字符不是英文字母则不转。</span></span><br><span class="line"><span class="comment">-- upper(str) 将给定参数的每一个字符，依次转成大写形式，若某个字符不是英文字母则不转。</span></span><br><span class="line"><span class="comment">-- initcap(str) 将给定参数的每个单词的首字母大写，其它字符转成小写。</span></span><br></pre></td></tr></table></figure></p>
<p><br>　　范例2：其它字符函数。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- concat(str1,str2)函数用于字符串连接，它将str2连接到str1的后面。</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">concat</span>(<span class="string">'Hi,'</span>,<span class="string">' Tomcat!'</span>) </span><br><span class="line"><span class="keyword">FROM</span>  dual;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- strsub(str,index,len)函数用于字符串截取。</span></span><br><span class="line"><span class="comment">-- 从下标为的index位置开始的位置，截取出一个长度为len的子串，其中参数len可以不指定。</span></span><br><span class="line"><span class="comment">-- 若index的值为0或1，则从str的开头第一个字符开始截取。</span></span><br><span class="line"><span class="comment">-- 若index的值为-1，则从str最后一个字符开始，向右截取。</span></span><br><span class="line"><span class="comment">-- 若不指定参数len，则从当前index指定的位置开始，向右截取到str右端最后一个字符。 </span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">substr</span>(<span class="string">'Hello'</span>,<span class="number">-5</span>,<span class="number">4</span>)</span><br><span class="line"><span class="keyword">FROM</span> dual;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- length(str)  计算出字符串str中包含的字符的个数。</span></span><br><span class="line"><span class="comment">-- lengthb(str) 计算出字符串str中包含的字节的个数。</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">length</span>(<span class="string">'Hi 汤姆!'</span>),lengthb(<span class="string">'Hi 汤姆!'</span>)</span><br><span class="line"><span class="keyword">FROM</span> dual;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- instr(str1,str2) 查找出str2在str1中首次出现的位置，若未出现则返回0。</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">instr</span>(<span class="string">'Hi Hi!'</span>,<span class="string">'H'</span>)</span><br><span class="line"><span class="keyword">FROM</span> dual;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- replace (str1,str2,str3)将str1中所有的str2替换成str3，若没有找到str2则不替换。 </span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">replace</span>(<span class="string">'Hiiii Hiii'</span>,<span class="string">'i'</span>,<span class="string">'*'</span>) </span><br><span class="line"><span class="keyword">FROM</span> dual;</span><br></pre></td></tr></table></figure></p>
<p><br>　　范例3：数值函数。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 对64.234整数部分的十位进行四舍五入</span></span><br><span class="line"><span class="comment">-- Round()函数有三种用法：</span></span><br><span class="line"><span class="comment">-- round(14.5)进行简单的4舍5入，不保留小数。</span></span><br><span class="line"><span class="comment">-- round(14.234,2)保留两位小数，然后对小数点后第三位进行4舍5入。</span></span><br><span class="line"><span class="comment">-- round(14.234,-2)对整数部分四舍五入，但会先把操作位之后的数直接截断。</span></span><br><span class="line"><span class="comment">--      当为-1时，对整数部分的个位进行4舍5入，个位之后的数被抛弃，依次类推。</span></span><br><span class="line"><span class="comment">-- 结果为：100</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">round</span>(<span class="number">64.234</span>,<span class="number">-2</span>)</span><br><span class="line"><span class="keyword">FROM</span> dual;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Trunc()函数同样有三种用法：</span></span><br><span class="line"><span class="comment">-- trunc(123.454)直接将小数部分丢到。</span></span><br><span class="line"><span class="comment">-- trunc(123.454,2)截取时保留2为小数，将第2位以后的小数都丢掉。</span></span><br><span class="line"><span class="comment">-- trunc(123.456,-1)将整数部分的个位和其后的位全部丢掉。</span></span><br><span class="line"><span class="comment">-- 结果为：120</span></span><br><span class="line"><span class="keyword">SELECT</span> trunc(<span class="number">123.456</span>,<span class="number">-1</span>)</span><br><span class="line"><span class="keyword">FROM</span> dual; </span><br><span class="line"></span><br><span class="line"><span class="comment">-- 这个运算用行话就是“取模”或“模除运算”，反正都带“模”，用白话说那就是计算余数。</span></span><br><span class="line"><span class="comment">-- 计算12除以5的余数。</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">mod</span>(<span class="number">12</span>,<span class="number">5</span>)</span><br><span class="line"><span class="keyword">FROM</span> dual;</span><br></pre></td></tr></table></figure></p>
<p><br>　　范例4：日期函数。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 获取当前时刻的日期</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">sysdate</span> <span class="keyword">FROM</span> dual;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 昨天和明天</span></span><br><span class="line"><span class="comment">-- 此处的+1和-1是以天为单位的。</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">sysdate</span><span class="number">-1</span>,<span class="keyword">sysdate</span>,<span class="keyword">sysdate</span>+<span class="number">1</span>  <span class="keyword">FROM</span> dual;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 日期 - 日期 = 相差的天数，日期不能直接使用“+”号与另一个日期相加。</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">round</span>((<span class="keyword">sysdate</span>-hiredate)/<span class="number">7</span>)</span><br><span class="line"><span class="keyword">FROM</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 计算所有员工至今加入公司的月数</span></span><br><span class="line"><span class="comment">-- Months_between()函数：返回给定日期之间相差的月份数，用第一个日期减去第二个日期。</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">round</span>(MONTHS_BETWEEN(<span class="keyword">sysdate</span>,hiredate))</span><br><span class="line"><span class="keyword">FROM</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询出本月的最后一天是几号。</span></span><br><span class="line"><span class="comment">-- last_day()返回指定日期，当月的最后一天。</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">LAST_DAY</span>(<span class="keyword">sysdate</span>)  <span class="keyword">FROM</span> dual;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 计算2个月后的日期。</span></span><br><span class="line"><span class="comment">-- ADD_MONTHS()函数，返回在指定日期上加上指定月份后的日期。</span></span><br><span class="line"><span class="keyword">SELECT</span> add_months(<span class="keyword">sysdate</span>,<span class="number">2</span>) <span class="keyword">FROM</span> dual;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 计算出下个星期一是几号。</span></span><br><span class="line"><span class="comment">-- NEXT_DAY函数，返回在指定日期之后的下一个指定日期的日期号。</span></span><br><span class="line"><span class="keyword">SELECT</span> next_day(<span class="keyword">sysdate</span>, ’星期一’) <span class="keyword">FROM</span> dual;</span><br></pre></td></tr></table></figure></p>
<p><br>　　范例5：转换函数。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 通过日期转换函数，将一个字符串转换成一个日期类型的数据。</span></span><br><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> Hiredate = <span class="keyword">to_date</span>(<span class="string">'1981-12-3'</span>,<span class="string">'yyyy-mm-dd'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 将当前日期中的“月份”给截取出来。</span></span><br><span class="line"><span class="comment">-- to_char(date,format)将date转换成format格式的字符串。 </span></span><br><span class="line"><span class="comment">-- yyyy  年份           hh  小时(12小时制)</span></span><br><span class="line"><span class="comment">-- mm    月份           mi  分钟</span></span><br><span class="line"><span class="comment">-- dd    日期           ss  秒</span></span><br><span class="line"><span class="comment">-- hh24  小时(24小时制)  dy  周一 至 周日</span></span><br><span class="line"><span class="keyword">SELECT</span> To_Char(<span class="keyword">sysdate</span>,’mm’) </span><br><span class="line"><span class="keyword">FROM</span> dual;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用fm可以去掉“1981-01-01”中月份和日期中的0。</span></span><br><span class="line"><span class="keyword">SELECT</span> to_char(hiredate,<span class="string">'fmyyyy-mm-dd'</span>)</span><br><span class="line"><span class="keyword">FROM</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 计算字符串 ’123’+’456’ 的结果</span></span><br><span class="line"><span class="keyword">SELECT</span> to_number(’<span class="number">123</span>’)+to_number(’<span class="number">456</span>’)</span><br><span class="line"><span class="keyword">FROM</span> dual;</span><br></pre></td></tr></table></figure></p>
<h3 id="组函数"><a href="#组函数" class="headerlink" title="组函数"></a>组函数</h3><p>　　分组，就是按用户指定的字段进行分组，将值相同的记录放在一起。而所谓组函数，就是用来操作每个分组中的数据。</p>
<blockquote>
<p>如按照员工的部门编号，将员工分在不同的组中。</p>
</blockquote>
<p><br>　　范例1：组函数。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- Count() 计算出当前组中的所有指定列上的值为非空的记录的个数。</span></span><br><span class="line"><span class="comment">-- Max()   计算出当前组中的最大值。</span></span><br><span class="line"><span class="comment">-- Min()   计算出当前组中的最小值。</span></span><br><span class="line"><span class="comment">-- Sum()   计算当前组中所有的数的和。</span></span><br><span class="line"><span class="comment">-- Avg()   计算当前组中的平均数。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 统计组内所有员工的工资的总和、平均工资。</span></span><br><span class="line"><span class="comment">-- 由于下面SQL里没有明确指定分组的规则，所以默认表内的所有记录处在一个组中。</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">sum</span>(sal),<span class="keyword">avg</span>(sal)  <span class="keyword">FROM</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 找出最高工资、最低工资</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">max</span>(sal) 最高工资,<span class="keyword">min</span>(sal) 最低工资</span><br><span class="line"><span class="keyword">FROM</span> emp;</span><br></pre></td></tr></table></figure></p>
<p>　　可以使用group by语句进行分组，一旦明确进行分组，则使用组函数就是分别对每一个组中的数据进行操作。</p>
<p><br>　　范例2：计算出各部门的人数以及平均工资。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 语句执行的过程： </span></span><br><span class="line"><span class="comment">-- 首先在数据库中找到emp表，然后执行group by语句，进行分组。</span></span><br><span class="line"><span class="comment">-- 由于emp表里的数据总共有3个部门，所以分成3个组，分别为：(10部门,20部门,30部门)。</span></span><br><span class="line"><span class="comment">-- 最后分别为每个分组调用一次SELECT语句。</span></span><br><span class="line"><span class="keyword">SELECT</span> deptno,<span class="keyword">count</span>(empno) ,<span class="keyword">avg</span>(sal)</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno;</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  程序中使用了GROUP BY分组，并指定按deptno(部门号)分组。
-  因此上面用的count()函数和avg()函数，是对每一个分组中的数据进行计算。说白了系统会自动为每一个分组都调用一次SELECT语句。
-  GROUP BY可以指定多个字段来进行分组，此时就与distinct一样，只有这些字段的值都相同的记录，才会别放到一组中。  
</code></pre><p><br>　　需要注意的是：</p>
<blockquote>
<p>若SQL中没有group by语句，且SELECT后面使用了组函数，则在SELECT语句中就不能再查询其他普通列了，但可以有多个组函数。<br>若脚本中使用了group by语句，则未出现在group by中的列，绝对不能出现在SELECT后面，但SELECT后面可以出现组函数。</p>
</blockquote>
<p><br>　　范例3：统计出不同部门中，不同工种的平均工资。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 只有两个员工的deptno列和job列上的值同时相同时，他们才会别分到同一个组中。</span></span><br><span class="line"><span class="keyword">select</span> deptno,job,<span class="keyword">avg</span>(sal)</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> deptno,job;</span><br></pre></td></tr></table></figure></p>
<p><br>　　范例4：查询出平均工资&gt;2000的部门号，然后按降序排列。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- having关键字用来对所有组返回值的进行筛选。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 按部门分组，将平均工资大于2000的部门的信息输出，此时就是对所有组返回值的进行筛选。</span></span><br><span class="line"><span class="comment">-- 其实Having和SELECT类似，系统也会为每一个分组都调用一次，having语句对分组进行筛选。  </span></span><br><span class="line"><span class="keyword">SELECT</span> deptno,<span class="keyword">avg</span>(sal) </span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno</span><br><span class="line"><span class="keyword">Having</span> <span class="keyword">avg</span>(sal)&gt;<span class="number">2000</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">2</span> <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure></p>
<p><br>　　范例5：按部门分组,查询出平局工资最高的部门。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 分组函数可以嵌套使用。</span></span><br><span class="line"><span class="comment">-- 内层函数计算每个组的平均工资，外层函数找出 所有组平均工资最大的那个工资。</span></span><br><span class="line"><span class="comment">-- 此时deptno不能出现在select后面。</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">max</span>(<span class="keyword">avg</span>(sal))</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno;</span><br></pre></td></tr></table></figure></p>
<p>　　各子句的执行顺序：</p>
<blockquote>
<p>首先执行FROM。<br>然后是Where进行筛选行。<br>接着是Group by进行分组。<br>然后是Having对分组进行筛选。<br>接着是select从筛选后剩下的组中提取数据。<br>最后是Order By对查询结构进行排序。</p>
</blockquote>
<h3 id="多表查询"><a href="#多表查询" class="headerlink" title="多表查询"></a>多表查询</h3><p>　　从多张表中查询数据，称为多表查询。多表查询时会产生笛卡尔积，若不对数据加以筛选，则查询出的数据可能就是错误的。</p>
<p>　　范例1：笛卡尔积。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 所谓笛卡尔积就是用emp的每一条记录依次和dept的表的每一条记录结合。</span></span><br><span class="line"><span class="comment">-- 所以最后查询出来的记录数量是：emp表的长度*dept表的长度。</span></span><br><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> emp ,dept;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 从笛卡尔全集中，筛选出符合要求的记录，此种连接方式被称为“等值连接”。</span></span><br><span class="line"><span class="keyword">SELECT</span> e.empno,e.ename,d.dname</span><br><span class="line"><span class="keyword">FROM</span> emp e,dept d</span><br><span class="line"><span class="keyword">WHERE</span> e.deptno=d.deptno;</span><br></pre></td></tr></table></figure></p>
<p><br>　　范例2：自连接。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询出每个员工的上司</span></span><br><span class="line"><span class="keyword">SELECT</span> e1.ename 员工,e2.ename 上司,e2.empno 上司的<span class="keyword">ID</span></span><br><span class="line"><span class="keyword">FROM</span>  emp e1,emp e2</span><br><span class="line"><span class="keyword">WHERE</span> e1.mgr=e2.empno;</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  您可以理解成从数据库中取了两次emp表，用e1代表员工表，用e2代表上司表。
-  开始的时候用e1的第一条记录依次和e2的每条记录匹配，如果e1的mgr(上司的编号)字段与e2表的empno字段相同,则说明找到了e1的上司。
-  然后继续使用e1的第二条记录依次和e2的每条记录匹配，然后重复执行下去。
</code></pre><p>　　提示：自连接的效率很低，只适合于表中数据很少的时候。</p>
<h3 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h3><p>　　子查询：在一个查询语句的内部，还包括另一个查询语句。特点：将内层查询的结果，作为外层查询的条件。<br><br>　　范例1：查询出比员工7782工资高的所有员工的信息。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> empno,ename,sal</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> sal&gt;(</span><br><span class="line">     <span class="keyword">SELECT</span> sal</span><br><span class="line">     <span class="keyword">FROM</span> emp</span><br><span class="line">     <span class="keyword">WHERE</span> empno=<span class="number">7782</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  要查询出比7782工资高的员工，首先得查出7782的工资是多少，然后再在外层查询中找出比7782工资高的员工的信息，就这么简单。
-  所有子查询的代码必须写在()中，只有group by中不可以使用子查询，其他地方均可以使用子查询。
-  当查询数据时，只有单独执行多条sql语句才可能完成某个任务时，就可以考虑使用子查询。 
</code></pre><p><br>　　范例2：查询出部门名称、部门员工数、部门平均工资、部门的最低收入雇员的姓名。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> temp.deptno 部门号,temp.dname 部门名称,temp.msl 最低工资,e.ename 领取人,</span><br><span class="line">    temp.c 部门人数,temp.a 部门平均工资</span><br><span class="line"><span class="keyword">FROM</span>  emp e, (</span><br><span class="line">    <span class="keyword">SELECT</span>  d.deptno,dname,<span class="keyword">count</span>(empno) c,<span class="keyword">avg</span>(sal) a,<span class="keyword">min</span>(sal) msl</span><br><span class="line">    <span class="keyword">FROM</span>  emp e,dept d</span><br><span class="line">    <span class="keyword">WHERE</span> e.deptno=d.deptno</span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> d.deptno,dname </span><br><span class="line">) temp</span><br><span class="line"><span class="keyword">WHERE</span> e.deptno=temp.deptno <span class="keyword">and</span> sal=msl;</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  复杂的SQL语句都不是一下就写出来的，而是一点一点堆起来的。 
</code></pre><p><br>　　在子查询中存在三种操作符号： <code>In</code>、<code>All</code>、<code>Any</code>。</p>
<p><br>　　范例3：使用范例。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询出各部门的最低工资的员工的信息</span></span><br><span class="line"><span class="comment">-- 此处的In就是Where中的In子句，是列表选择符。</span></span><br><span class="line"><span class="comment">-- 下面代码含义为：如果sal的值是子查询中返回值的任何一个，则就返回true。</span></span><br><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> sal <span class="keyword">IN</span>(</span><br><span class="line">     <span class="keyword">SELECT</span> <span class="keyword">min</span>(sal)</span><br><span class="line">     <span class="keyword">FROM</span> emp</span><br><span class="line">     <span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 一般来说使用ALL操作符时，都会配合用&lt;或者&gt;号。</span></span><br><span class="line"><span class="comment">-- “&gt;ALL”代表大于子查询返回的所有值才返回true。</span></span><br><span class="line"><span class="comment">-- “&lt;ALL”代表小于子查询返回的所有值才返回true。</span></span><br><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> sal &gt;ALL(</span><br><span class="line">     <span class="keyword">SELECT</span> <span class="keyword">min</span>(sal)</span><br><span class="line">     <span class="keyword">FROM</span> emp</span><br><span class="line">     <span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<h3 id="集合运算"><a href="#集合运算" class="headerlink" title="集合运算"></a>集合运算</h3><p>　　所谓的集合运算，就是对具有相同列的集合，执行交、并、差三种运算。<br>　　需要注意的是：</p>
<blockquote>
<p>参与运算的各个集合，必须列数相同且列的类型一致。<br>使用第一个集合的表头作为结果集中的各个列的列名。</p>
</blockquote>
<p><br>　　范例1：常用函数。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 交运算，就是找出同时存在于这两个表中的所有元素。</span></span><br><span class="line"><span class="comment">-- 所以结果就是将20部门中的员工查出，即找出两个集合中都有的记录。</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">INTERSECT</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> emp <span class="keyword">where</span> deptno = <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 并运算。</span></span><br><span class="line"><span class="comment">-- 将两个集合的所有数据加在一起，如果有重复的行则自动消除重复。</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> emp <span class="keyword">where</span> deptno = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 差运算。</span></span><br><span class="line"><span class="comment">-- 选择出存在于第一个表，但不存在于第二个表中的记录。</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">MINUS</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> emp <span class="keyword">where</span> deptno = <span class="number">10</span>;</span><br></pre></td></tr></table></figure></p>
<p>　　集合运算一般只适合操作小表，否则效率很低。</p>
<h2 id="数据增删改"><a href="#数据增删改" class="headerlink" title="数据增删改"></a>数据增删改</h2><p><br>　　范例1：插入数据。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 插入语句分为两部分：字段列表和值列表，其中emp是表名，其后跟着的是字段列表。</span></span><br><span class="line"><span class="comment">-- 向emp表中插入一个员工</span></span><br><span class="line"><span class="keyword">Insert</span> <span class="keyword">into</span> emp(empno,ename,job,mgr,hiredate,sal,comm,deptno) </span><br><span class="line"><span class="keyword">values</span> (<span class="number">1005</span>,’cxy’,’MANAGER’,<span class="number">7788</span>,<span class="keyword">sysdate</span>,<span class="number">5100</span>,<span class="number">3000</span>,<span class="number">40</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 若要为表中所有的列赋值，则可以在emp后面不写出字段列表，但值列表中必须为所有列提供值，并且顺序要和表中列的顺序相同。</span></span><br><span class="line"><span class="comment">-- 若暂时不想给某些列赋值,可不将该列放到字段列表中。也可以放进去,但赋值为null。</span></span><br><span class="line"><span class="keyword">Insert</span> <span class="keyword">into</span> emp <span class="keyword">values</span>(<span class="number">1005</span>,’cxy’,’MANAGER’,<span class="literal">null</span>,<span class="keyword">sysdate</span>,<span class="number">5100</span>,<span class="number">3000</span>,<span class="number">40</span>);</span><br></pre></td></tr></table></figure></p>
<p><br>　　范例2：删除数据。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 删除ID为7369的员工的信息</span></span><br><span class="line"><span class="comment">-- DELETE FROM语句 是删除行。如果不加上WHERE子句进行限制，则删除表中的所有数据。</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> empno=<span class="number">7369</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除ID为7369、1005、7698的员工的信息</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> empno <span class="keyword">in</span>(<span class="number">7369</span>,<span class="number">1005</span>,<span class="number">7698</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 截断表</span></span><br><span class="line"><span class="comment">-- 所谓截断表说，就是删除表中的所有记录，同时将修改提交到数据库，使用rollback无效。</span></span><br><span class="line"><span class="comment">-- 使用截断表可以使指定表所占的资源立即释放。</span></span><br><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> Student;</span><br></pre></td></tr></table></figure></p>
<p><br>　　范例3：更新数据。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 修改ID为1005的员工的工资为8000，奖金为6000</span></span><br><span class="line"><span class="comment">-- 修改多个字段的值时使用逗号间隔</span></span><br><span class="line"><span class="comment">-- 使用 update set 语句来更新表中的数据，若不使用WHERE进行限制，则修改表中的所有记录。 </span></span><br><span class="line"><span class="keyword">UPDATE</span> emp</span><br><span class="line"><span class="keyword">SET</span> sal=<span class="number">8000</span>,comm=<span class="number">6000</span></span><br><span class="line"><span class="keyword">WHERE</span> empno=<span class="number">1005</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 将ID为7369、7839、7698的员工的工资提高1000元</span></span><br><span class="line"><span class="keyword">UPDATE</span> emp</span><br><span class="line"><span class="keyword">SET</span> sal=sal+<span class="number">1000</span> </span><br><span class="line"><span class="keyword">WHERE</span> empno <span class="keyword">in</span> (<span class="number">7369</span>,<span class="number">7839</span>,<span class="number">7698</span>);</span><br></pre></td></tr></table></figure></p>
<h2 id="对象管理"><a href="#对象管理" class="headerlink" title="对象管理"></a>对象管理</h2><p>　　在Oracle中，存在有如下的数据库对象：</p>
<blockquote>
<p>表     基本的数据存储集合，由行和列组成。<br>视图   从表中抽出的逻辑上相关的数据集合。<br>序列   提供有规律的数值。<br>索引   提高查询的效率。</p>
</blockquote>
<h3 id="表"><a href="#表" class="headerlink" title="表"></a>表</h3><p>　　在Oracle中想要创建一个表，必须要知道Oracle的常用数据类型。</p>
<center><br><img src="/img/base/base003_02.png" alt=""><br></center>

<p><br>　　范例1：常见操作。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--  student是表名，表中每个字段之间用逗号间隔，最后一个字段不需要用逗号。</span></span><br><span class="line"><span class="comment">--  default关键字可以为字段指定默认值，insert语句没有为sex列提供数据时，则使用默认值。 </span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> student(</span><br><span class="line">    <span class="keyword">sid</span>    <span class="built_in">number</span>(<span class="number">5</span>) ,</span><br><span class="line">    sname <span class="built_in">varchar</span>(<span class="number">10</span>),</span><br><span class="line">    sex   <span class="built_in">varchar</span>(<span class="number">2</span>)  <span class="keyword">default</span> <span class="string">'男'</span>,</span><br><span class="line">    age   <span class="built_in">number</span> (<span class="number">3</span>) ,</span><br><span class="line">    birthday <span class="built_in">date</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用子查询的结果来创建一张表，表所具有的列，就是子查询返回的列。</span></span><br><span class="line"><span class="comment">-- 也可以在表名的后面为表中的列自定义列名。</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> emp20</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> deptno=<span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 增加列</span></span><br><span class="line"><span class="keyword">Alter</span> <span class="keyword">table</span> Student </span><br><span class="line"><span class="keyword">add</span>(school <span class="built_in">varchar</span>(<span class="number">20</span>)  <span class="keyword">default</span>  ’美国二中’ , height <span class="built_in">number</span>(<span class="number">3</span>) <span class="keyword">default</span> <span class="number">170</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 修改列</span></span><br><span class="line"><span class="comment">-- 修改列的长度但不改变列的类型，如将varchar(20)改成varchar(10)。若表中有一个记录的长度为15，此时新列的长度必须&gt;=15。</span></span><br><span class="line"><span class="comment">-- 修改列的类型时，若新旧类型不兼容，则只有在该列中无数据的时候，列的类型才能被修改。</span></span><br><span class="line"><span class="comment">-- 修改列时，对默认值的修改只影响今后插入到表中的行。</span></span><br><span class="line"><span class="keyword">Alter</span> <span class="keyword">table</span> Student</span><br><span class="line"><span class="keyword">Modify</span>(school <span class="built_in">varchar</span>(<span class="number">10</span>) <span class="keyword">default</span> (’英国二中’));</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除列</span></span><br><span class="line"><span class="keyword">Alter</span> <span class="keyword">table</span> student <span class="keyword">drop</span> <span class="keyword">column</span> sex;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 重命名列</span></span><br><span class="line"><span class="keyword">Alter</span> <span class="keyword">table</span> sstudent <span class="keyword">rename</span> <span class="keyword">column</span> sex <span class="keyword">to</span> fuck;</span><br></pre></td></tr></table></figure></p>
<h3 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h3><p>　　一个视图实际上就是封装了一个复杂的查询语句。</p>
<p><br>　　范例1： 建立一个视图，此视图包括工资大于2000的所有员工的信息。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--  视图有2个大作用：</span></span><br><span class="line"><span class="comment">--  保证数据的安全性：比如员工表中包含了公司全体员工的信息，很显然对于某一个部门的领导来说，他只能看他所领导的员工的信息，其他员工的信息他不应该看到。因此可以在这个员工表的基础上，为每一个部门建立一个视图，然后根据这个领导的部门编号来决定这个领导有权利查询哪一个视图。</span></span><br><span class="line"><span class="comment">--  提高“查询速度”：如果这条查询语句很长、很复杂，那么我们每次都得要查询数据时，都要重新写一遍就太慢了。 </span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> sal2000</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> * </span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> sal&gt;=<span class="number">2000</span>;</span><br></pre></td></tr></table></figure></p>
<p><br>　　范例2： 查看视图。<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--  比如我们可以将下面的语句保存成一个视图 </span></span><br><span class="line"><span class="keyword">SELECT</span> temp.deptno 部门号,temp.dname 部门名称,temp.msl 最低工资,e.ename 领取人,temp.c 部门人数,temp.a 部门平均工资</span><br><span class="line"><span class="keyword">FROM</span>  emp e, (</span><br><span class="line">        <span class="keyword">SELECT</span>  d.deptno,dname,<span class="keyword">count</span>(empno) c,<span class="keyword">avg</span>(sal) a,<span class="keyword">min</span>(sal) msl</span><br><span class="line">        <span class="keyword">FROM</span>  emp e,dept d</span><br><span class="line">        <span class="keyword">WHERE</span> e.deptno=d.deptno</span><br><span class="line">        <span class="keyword">GROUP</span> <span class="keyword">BY</span> d.deptno,dname </span><br><span class="line">      ) temp</span><br><span class="line"><span class="keyword">WHERE</span> e.deptno=temp.deptno <span class="keyword">and</span> sal=msl;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 然后通过最简单的查询语句就能得到结果，甚至可以使用WHERE语句</span></span><br><span class="line"><span class="keyword">SELECT</span> * </span><br><span class="line"><span class="keyword">FROM</span> 视图名;</span><br><span class="line">WHERE sal2000&gt;4000;</span><br></pre></td></tr></table></figure></p>
<p><br>　　范例3： 其它操作。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 删除视图</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> sal2000;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 重建视图</span></span><br><span class="line"><span class="comment">-- 视图只是一个逻辑存在的表，它根本就是虚拟出来的。</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> <span class="keyword">REPLACE</span> <span class="keyword">VIEW</span> sal2000</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> sal&gt;<span class="number">3000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用视图更新数据和使用基本表更新数据的操作是一样的。</span></span><br><span class="line"><span class="comment">-- 如果视图是由多张表中抽取的数据组成的，则不可以通过修改视图来修改原表。</span></span><br><span class="line"><span class="comment">-- 可以通过对视图的插入、删除、更新，来间接操作基本表。</span></span><br><span class="line"><span class="keyword">UPDATE</span> sal2000</span><br><span class="line"><span class="keyword">SET</span> sal=sal+<span class="number">10</span></span><br><span class="line"><span class="keyword">WHERE</span> empno=<span class="number">1005</span>;</span><br></pre></td></tr></table></figure></p>
<h2 id="约束"><a href="#约束" class="headerlink" title="约束"></a>约束</h2><p>　　在一张表中约束是必不可少的，使用约束可以更好的保证数据库中的数据的完整性。 </p>
<blockquote>
<p>说白了约束就是限制，给某张表增加约束后，当用户向表中插入数据的时候，会对该数据进行检查，如果违反了我们事先定义好的约束，则DBMS就不允许此数据进表。</p>
<p>在实际应用中，约束主要分为如下5类：<br>主键约束<br>唯一约束<br>检查约束<br>非空约束<br>外键约束</p>
</blockquote>
<p>　　<strong>主键约束</strong><br>　　主键能唯一标识一个记录。比如咱们的身份证号，就可以做为唯一区分我们每一个人的标识。主键具有如下的特点： </p>
<blockquote>
<p>1、被设为主键的列，在INSERT INTO中必须为主键列赋值。<br>2、表中所有记录在此列上的值互不能相同，否则DBMS将拒绝新数据插入到表中。<br>3、一般来说主键都用在ID上，如学号、教师号、学籍号等。<br>4、使用Primary key关键字在创建表的时候定义主键。</p>
</blockquote>
<p><br>　　范例1： 定义主键。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 列级主键，在列的类型的后面，跟着“Primary key”</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Student(</span><br><span class="line">     <span class="keyword">Sid</span>  <span class="built_in">number</span> (<span class="number">11</span>) Primary <span class="keyword">key</span>,</span><br><span class="line">     <span class="keyword">Name</span> <span class="built_in">varchar</span> (<span class="number">8</span>)  </span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 表级主键，在表的最后，使用“CONSTRAINT”关键字。</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Student(</span><br><span class="line">     <span class="keyword">Sid</span>  <span class="built_in">number</span> ( <span class="number">11</span>),</span><br><span class="line">     <span class="keyword">Name</span> <span class="built_in">varchar</span> ( <span class="number">8</span>)  ,</span><br><span class="line">     <span class="keyword">CONSTRAINT</span> Student_sid_pk Primary <span class="keyword">Key</span>(<span class="keyword">Sid</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 一个主键可以包含多个列，当主键包含多个列的时候，主键被称为是主键组。</span></span><br><span class="line"><span class="comment">-- 如果需要定义主键组，则可以这样写：</span></span><br><span class="line"><span class="comment">-- CONSTRAINT Student_sid_pk Primary Key(Sid,name)</span></span><br></pre></td></tr></table></figure></p>
<p>　　<strong>唯一约束</strong><br>　　主键有一个特点，就是各记录的主键值不能相同。<br>　　但是一个表中只能有一个主键，如果还有其他的列也不希望出现重复值，该怎么办？可以使用唯一键，它可以保证表中所有记录的，指定列上的值互不相同，同时一个表可以有多个唯一键。</p>
<p>　　范例1： 定义唯一键。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 列级唯一键，在列的类型的后面，跟着“unique”</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Student(</span><br><span class="line">     <span class="keyword">Sid</span>    <span class="built_in">number</span>(<span class="number">20</span>)  primary <span class="keyword">key</span>,</span><br><span class="line">     <span class="keyword">Name</span>   <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">unique</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 表级唯一键，在表的最后，使用“UNIQUE”关键字。</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Student(</span><br><span class="line">     <span class="keyword">Sid</span>    <span class="built_in">number</span>(<span class="number">20</span>)  primary <span class="keyword">key</span>,</span><br><span class="line">     <span class="keyword">Name</span>   <span class="built_in">varchar</span>(<span class="number">20</span>) ,</span><br><span class="line">     <span class="keyword">CONSTRAINT</span> Student_name_uk <span class="keyword">UNIQUE</span>(<span class="keyword">name</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 相应的也可以创建唯一键组。</span></span><br><span class="line"><span class="comment">-- 只有当新数据与已存在的数据在唯一键键组上的每一列的值都相同时，才判定新数据违反了唯一键约束。</span></span><br></pre></td></tr></table></figure></p>
<p>　　<strong>检查约束</strong></p>
<p>　　所谓检查约束，就是由咱们自己指定限制的条件。</p>
<blockquote>
<p>主键、唯一键约束都是自动检测数据是否合法，我们自己没有对它们说该怎么样检测。<br>那么如果咱们有如下限制：<br>1、限制学生的sex(性别)的取值为：男、女。<br>2、限制学生的年龄在20到50岁之间<br>此时不论用主键还是唯一键都不行，它们只能检测是否重复，此时就用到了检查约束。</p>
</blockquote>
<p>　　范例1： 检查约束。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 列级检查约束，在列的类型的后面，跟着“check”</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Student(</span><br><span class="line">     <span class="keyword">Sid</span>    <span class="built_in">number</span>(<span class="number">20</span>)  primary <span class="keyword">key</span>,</span><br><span class="line">     <span class="keyword">Name</span>   <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">unique</span>,</span><br><span class="line">     Sex    <span class="built_in">varchar</span>(<span class="number">2</span>) <span class="keyword">default</span> (’男’) <span class="keyword">check</span>(sex <span class="keyword">in</span>(’男’ ,’女’)) </span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 需要注意的是default必须放在check约束之前写。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 同样可以限制年龄</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Student <span class="keyword">ADD</span>(age <span class="built_in">number</span>(<span class="number">3</span>) <span class="keyword">check</span>(age <span class="keyword">between</span> <span class="number">20</span> <span class="keyword">and</span> <span class="number">130</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 定义表级检查约束</span></span><br><span class="line">CONSTRAINT Student_age_ck <span class="keyword">CHECK</span>( age  <span class="keyword">between</span> <span class="number">20</span> <span class="keyword">and</span> <span class="number">130</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 检查约束组</span></span><br><span class="line"><span class="keyword">CONSTRAINT</span> Student_age_sex_ck  </span><br><span class="line"><span class="keyword">CHECK</span>( age <span class="keyword">between</span> <span class="number">20</span> <span class="keyword">and</span> <span class="number">130</span>) , <span class="keyword">CHECK</span> (sex <span class="keyword">in</span>(’男’,’女’))</span><br></pre></td></tr></table></figure></p>
<p>　　<strong>非空约束</strong></p>
<p>　　所谓非空约束，就是使用INSERT INTO插入数据时，必须给被设为非空的列指定值。</p>
<p>　　范例1： 非空约束。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 非空约束，在列的类型的后面，跟着“not null”</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Student(</span><br><span class="line">     <span class="keyword">Sid</span>    <span class="built_in">number</span>(<span class="number">20</span>)  primary <span class="keyword">key</span>,</span><br><span class="line">     <span class="keyword">Name</span>   <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">unique</span>,</span><br><span class="line">     age    <span class="built_in">number</span>(<span class="number">3</span>)   <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">     Sex    <span class="built_in">varchar</span>(<span class="number">2</span>) <span class="keyword">default</span> (<span class="string">'男'</span>) ,</span><br><span class="line"><span class="keyword">CONSTRAINT</span> Student_age_sex_ck  </span><br><span class="line"><span class="keyword">CHECK</span>( age <span class="keyword">between</span> <span class="number">20</span> <span class="keyword">and</span> <span class="number">130</span>) , <span class="keyword">CHECK</span> (sex <span class="keyword">in</span>(’男’,’女’))</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p>　　<strong>外键约束</strong></p>
<p>　　所谓的外键约束，就是在向A表中插入数据时，会先去B表判断一些数据是否存在。如果存在，则DBMS才允许新数据插入到数据库中。</p>
<p>　　假设我们现在有3张表：Student(学生表)、Course(课程表)、grade(分数表)。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 学生表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Student(</span><br><span class="line">    <span class="keyword">Sid</span>   <span class="built_in">number</span>(<span class="number">6</span>) primary <span class="keyword">key</span>,</span><br><span class="line">    <span class="keyword">Name</span> <span class="built_in">varchar</span>(<span class="number">8</span>) <span class="keyword">not</span> <span class="literal">null</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 课程表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Course(</span><br><span class="line">    Cid    <span class="built_in">number</span>(<span class="number">6</span>)  primary <span class="keyword">key</span>,</span><br><span class="line">    Cname <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="literal">null</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 分数表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Grade(</span><br><span class="line">    <span class="keyword">Sid</span>     <span class="built_in">number</span>(<span class="number">6</span>) ,</span><br><span class="line">    Cid    <span class="built_in">number</span>(<span class="number">6</span>),</span><br><span class="line">    Score  <span class="built_in">number</span>(<span class="number">3</span>)  </span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p>　　一个学生选修一门课程，等到期末考试后，就会产生一个成绩。<br>　　正确的逻辑应该是，加入到Grade表中的记录的Sid、Cid必须得是已经存在于Student和Course表中，如果不存在，则就没必要加入了。</p>
<p>　　范例1： 外键约束。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Grade(</span><br><span class="line">    <span class="comment">-- 列级外键约束，在列的类型的后面，跟着“REFERENCES”</span></span><br><span class="line">    <span class="keyword">Sid</span>     <span class="built_in">number</span>(<span class="number">6</span>)  <span class="keyword">REFERENCES</span> Student(<span class="keyword">Sid</span>),</span><br><span class="line">    Cid    <span class="built_in">number</span>(<span class="number">6</span>),</span><br><span class="line">    Score  <span class="built_in">number</span>(<span class="number">3</span>) ,</span><br><span class="line">    <span class="comment">-- 表级外键约束</span></span><br><span class="line">    <span class="keyword">CONSTRAINT</span> Course_Grade_cid_fk FOREIGN <span class="keyword">KEY</span>(Cid)</span><br><span class="line">             <span class="keyword">REFERENCES</span> Course(Cid)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 此时我们称Grade表是子表，Student和Course表为父表。</span></span><br><span class="line"><span class="comment">-- 在子表中设置的外键在父表中必须是主键。 </span></span><br><span class="line"><span class="comment">-- 删除时应该先删除子表的数据，再删除父表的数据。</span></span><br></pre></td></tr></table></figure></p>
<p>　　当父表的记录被子表引用的时候，删除主表记录时的三种情况：</p>
<blockquote>
<p>空值删除：就是允许用户删除主表中的记录，但是会将子表中引用了父表中记录的记录上的该字段的取值设置为null。<br>级联删除：就是允许用户删除主表中的记录，但会将子表中引用此记录的所有记录一起删除。<br>拒绝删除：就是不允许删除，在删除的时候会错误提示。</p>
</blockquote>
<h2 id="数据库编程"><a href="#数据库编程" class="headerlink" title="数据库编程"></a>数据库编程</h2><p>　　使用常见的SQL语言无法完成复杂的业务，如循环、复杂判断等，因此在Oracle中提供了PL/SQL编程。</p>
<h3 id="PL-SQL基础"><a href="#PL-SQL基础" class="headerlink" title="PL/SQL基础"></a>PL/SQL基础</h3><p>　　PL/SQL(Procedure Language/SQL)是Oracle对SQL语言的过程化扩展，其在SQL命令语言中增加了过程处理语句(如分支、循环等)，使SQL语言具有过程处理能力。</p>
<blockquote>
<p>其实各种数据库都对SQL语言进行了过程化扩充，Oracle中的PL/SQL在SQLServer中叫做Transact-sql(简称T-SQL) 。</p>
</blockquote>
<p>　　范例1： 程序结构。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span></span><br><span class="line">  <span class="comment">-- 变量声明部分。</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="comment">-- 程序主体。</span></span><br><span class="line"><span class="keyword">exception</span></span><br><span class="line">  <span class="comment">-- 异常处理语句</span></span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line">/ <span class="comment">-- 每一个pl/sql程序都是以一个“/”符结束。</span></span><br></pre></td></tr></table></figure></p>
<p>　　范例2： 简单变量。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 若程序中不定义变量，则可以不写declare关键字。</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">  <span class="comment">--  变量的定义格式：变量名 数据类型 := 默认值，可以不指定默认值。</span></span><br><span class="line">  <span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">10</span>) := <span class="string">'Oracle'</span>;</span><br><span class="line">  age  number      :=  35;</span><br><span class="line">  birthday date    := sysdate;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="comment">-- 使用此函数可以向控制台输出一行数据。</span></span><br><span class="line">  <span class="comment">-- 默认情况下，屏幕输出是被禁用的，可以通过set serveroutput on;命令来开启。</span></span><br><span class="line">  dbms_output.put_line(<span class="string">'姓名：'</span>||<span class="keyword">name</span>);</span><br><span class="line">  <span class="comment">-- 字符串连接需要使用‘||’符号</span></span><br><span class="line">  dbms_output.put_line('年龄：'||age);</span><br><span class="line">  dbms_output.put_line('生日：'||birthday);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line">/</span><br></pre></td></tr></table></figure></p>
<p>　　范例3： 变量赋值。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span></span><br><span class="line">  <span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">10</span>);</span><br><span class="line">  sal number;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="comment">-- 可以使用into关键字将SELECT查询语句返回的值赋给变量。</span></span><br><span class="line">  <span class="keyword">SELECT</span> ename,sal <span class="keyword">into</span> <span class="keyword">name</span>,sal <span class="keyword">from</span> emp <span class="keyword">where</span> empno=<span class="number">7788</span>;</span><br><span class="line">  dbms_output.put_line('姓名：'||name);</span><br><span class="line">  dbms_output.put_line('工资：'||sal);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line">/</span><br></pre></td></tr></table></figure></p>
<p>　　范例4： 引用型变量。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 所谓的引用型变量，变量的类型引用自其他表中的某一列的数据类型。</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">  <span class="comment">-- 类型是emp表中ename列的类型。</span></span><br><span class="line">  <span class="keyword">name</span> emp.ename%<span class="keyword">type</span>;</span><br><span class="line">  <span class="comment">-- 类型是emp表中sal列的类型。</span></span><br><span class="line">  sal emp.sal%type;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">SELECT</span> ename,sal <span class="keyword">into</span> <span class="keyword">name</span>,sal <span class="keyword">from</span> emp <span class="keyword">where</span> empno=<span class="number">7788</span>;</span><br><span class="line">  dbms_output.put_line('姓名：'||name);</span><br><span class="line">  dbms_output.put_line('工资：'||sal);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line">/</span><br></pre></td></tr></table></figure></p>
<p>　　范例5： 记录型变量。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 所谓的记录型变量，其实就是一个集合类型，它可以保存表的某一行数据。</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">  ep emp%rowtype;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">SELECT</span> * <span class="keyword">into</span> ep <span class="keyword">from</span> emp <span class="keyword">where</span> empno=<span class="number">7788</span>;</span><br><span class="line">  <span class="comment">-- 通过ep来进一步访问行中的某一列的数据</span></span><br><span class="line">  dbms_output.put_line('姓名：'||ep.ename);</span><br><span class="line">  dbms_output.put_line('工资：'||ep.sal);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line">/</span><br></pre></td></tr></table></figure></p>
<p>　　范例6： 流程控制。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- IF语句</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">  n <span class="built_in">varchar</span>(<span class="number">10</span>) := <span class="number">1</span>;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="comment">-- 在if和elsif之后，需要使用then关键字。</span></span><br><span class="line">  <span class="keyword">if</span> n=<span class="number">5</span> <span class="keyword">then</span> dbms_output.put_line(<span class="string">'优秀'</span>);</span><br><span class="line">    elsif n=4 then dbms_output.put_line('良好');</span><br><span class="line">    elsif n=3 then dbms_output.put_line('及格');</span><br><span class="line">    else dbms_output.put_line('很差');</span><br><span class="line">  <span class="comment">-- IF语句的最后面必须要跟随下面的语句</span></span><br><span class="line">  <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用While语句可以进行循环操作，循环体放到loop与endloop之间。</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">  i <span class="built_in">number</span>:=<span class="number">1</span>;</span><br><span class="line">  len number :=10;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">WHILE</span> i&lt;<span class="keyword">len</span> </span><br><span class="line">  <span class="keyword">LOOP</span></span><br><span class="line">     dbms_output.put_line(i);</span><br><span class="line">     i:=i +1;</span><br><span class="line">  <span class="keyword">END</span> <span class="keyword">LOOP</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="comment">-- for循环1</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1.</span><span class="number">.10</span></span><br><span class="line">  <span class="keyword">loop</span></span><br><span class="line">    dbms_output.put_line(i);</span><br><span class="line">  <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="comment">-- for循环2</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> (<span class="keyword">select</span> * <span class="keyword">from</span> emp)</span><br><span class="line">  <span class="keyword">loop</span></span><br><span class="line">    dbms_output.put_line(<span class="string">'编号：'</span>||i.empno||<span class="string">'姓名：'</span>||i.ename);</span><br><span class="line">  <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 另一种循环</span></span><br><span class="line"><span class="keyword">declare</span> </span><br><span class="line">  i <span class="built_in">number</span>:=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">loop</span></span><br><span class="line">  dbms_output.put_line(<span class="string">'OK'</span>);</span><br><span class="line">  <span class="comment">-- 当i&gt;5的时候结束循环 </span></span><br><span class="line">  exit when i&gt;5;</span><br><span class="line">  i := i + 1;</span><br><span class="line">  exit when i=5;</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line">/</span><br></pre></td></tr></table></figure></p>
<p>　　范例7： 游标。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span></span><br><span class="line">  <span class="comment">--  游标用来保存一组记录型变量。</span></span><br><span class="line">  <span class="keyword">cursor</span> cr <span class="keyword">is</span> <span class="keyword">select</span> ename,sal <span class="keyword">from</span> emp;</span><br><span class="line">  name  emp.ename%type;</span><br><span class="line">  sal   emp.sal%type;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="comment">-- 打开游标。</span></span><br><span class="line">    <span class="keyword">open</span> cr;</span><br><span class="line">      loop </span><br><span class="line">          <span class="comment">-- 从光标中取出一行数据。 </span></span><br><span class="line">          fetch cr into name,sal;</span><br><span class="line">          <span class="comment">-- 若没有娶到数据，则结束循环。</span></span><br><span class="line">          exit when cr%notfound;</span><br><span class="line">          <span class="comment">-- 输出数据。</span></span><br><span class="line">          dbms_output.put_line('姓名：'||name||' 工资：'||sal);</span><br><span class="line">      <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line">    <span class="comment">-- 关闭游标。</span></span><br><span class="line">    close cr;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 带参数游标</span></span><br><span class="line"><span class="comment">-- 若游标包含参数，则参数可以在游标的名称后面书写，在子查询中可以直接使用游标的参数。</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">   <span class="keyword">cursor</span> c(empno <span class="built_in">number</span>) <span class="keyword">is</span></span><br><span class="line">     <span class="keyword">select</span> ename,sal <span class="keyword">from</span> emp <span class="keyword">where</span> empno = empno;</span><br><span class="line">   ename emp.ename%type;</span><br><span class="line">   sal   emp.sal%type;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="comment">-- 打开游标并传递参数过去</span></span><br><span class="line">  <span class="keyword">open</span> c(<span class="number">7788</span>);</span><br><span class="line">    fetch c into ename,sal;</span><br><span class="line">    dbms_output.put_line('姓名：'||ename||' 工资：'||sal);</span><br><span class="line">  close c;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line">/</span><br></pre></td></tr></table></figure></p>
<p>　　范例8： 异常处理。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- Oracle 内置的系统异常：</span></span><br><span class="line"><span class="comment">-- No_data_found      没有找到数据。</span></span><br><span class="line"><span class="comment">-- Too_many_rows      select …into语句匹配多个行。</span></span><br><span class="line"><span class="comment">-- Zero_Divide        除数为零。</span></span><br><span class="line"><span class="comment">-- Value_error        算术或转换错误。</span></span><br><span class="line"><span class="comment">-- Timeout_on_resource   在等待资源时发生超时。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 在Oracle中若某行语句产生了异常，则程序流程会立刻放弃当前代码的执行。</span></span><br><span class="line"><span class="comment">-- 并跳转到exception块中匹配异常，因此本范例同一时间内只会抛出一种异常。</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line"> n <span class="built_in">number</span> := <span class="number">1</span>;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  dbms_output.put_line(to_number(<span class="keyword">sysdate</span>));</span><br><span class="line">  dbms_output.put_line(n/0);  </span><br><span class="line">  exception </span><br><span class="line">    when zero_divide then   dbms_output.put_line('除数为0');  </span><br><span class="line">    when value_error then   dbms_output.put_line('数据类型转换失败!');  </span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 自定义异常</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">  <span class="comment">-- 定义一个exception类型的变量。</span></span><br><span class="line">  excep <span class="keyword">exception</span>;</span><br><span class="line">  time date;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="comment">-- 通过raise关键字将异常抛出，然后在exception块中处理异常。</span></span><br><span class="line">  <span class="keyword">if</span> <span class="keyword">time</span> <span class="keyword">is</span> <span class="literal">null</span> <span class="keyword">then</span> <span class="keyword">raise</span> excep;</span><br><span class="line">  <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line">  exception</span><br><span class="line">     when excep then dbms_output.put_line('哼哼! NullPointException');</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line">/</span><br></pre></td></tr></table></figure></p>
<h3 id="触发器"><a href="#触发器" class="headerlink" title="触发器"></a>触发器</h3><p>　　所谓的<font color="red">触发器</font>，是一个与表相关联的<code>PL/SQL</code>程序。<br>　　即我们事先在一个表上添加一个触发器，当用户操作(<code>insert</code>、<code>update</code>、<code>delete</code>)这个表时，触发器就会做出相应的反应。触发器分为两类：<font color="red">语句(表)级触发器</font>和<font color="red">行级触发器</font>。</p>
<blockquote>
<p>语句级触发器：不论SQL语句影响了表中多少条记录，触发器只会被触发一次。<br>行级触发器：Oracle会为每条受影响的记录触发一次触发器。</p>
</blockquote>
<p>　　范例1： 触发器语法。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 中括号内的内容是可以省写的。</span></span><br><span class="line"><span class="keyword">create</span>  [<span class="keyword">or</span> <span class="keyword">replace</span>] <span class="keyword">trigger</span>  触发器名</span><br><span class="line"><span class="comment">-- 大括号内的内容是必写的。</span></span><br><span class="line"><span class="comment">-- 触发器根据触发的时间又可以分为：操作之前触发和操作之后触发，分别使用before和after关键字。</span></span><br><span class="line">&#123;<span class="keyword">before</span> | <span class="keyword">after</span>&#125;</span><br><span class="line"><span class="comment">-- 使用delete、insert、update关键字来指定触发器在用户执行何种操作时触发。</span></span><br><span class="line">&#123;<span class="keyword">delete</span> | <span class="keyword">insert</span> | <span class="keyword">update</span> [<span class="keyword">of</span> 列名]&#125; </span><br><span class="line"><span class="comment">-- 使用on关键字指出触发器建立在哪张表中。</span></span><br><span class="line"><span class="keyword">on</span>  表名</span><br><span class="line">[<span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">row</span> [<span class="keyword">when</span>(条件) ] ]</span><br><span class="line">PLSQL 块</span><br></pre></td></tr></table></figure></p>
<p>　　范例2： 插入数据。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">trigger</span> <span class="keyword">test</span></span><br><span class="line"><span class="comment">-- 当用户向emp表中插入数据之时，会触发此触发器。</span></span><br><span class="line"><span class="comment">-- 若触发器被顺利执行完毕，则Oracle会将用户的数据插入到emp表中去。</span></span><br><span class="line"><span class="comment">-- 若触发器中抛出了异常，则Oracle不会将用户的数据插入到emp表中去。</span></span><br><span class="line"><span class="keyword">before</span> <span class="keyword">insert</span> <span class="keyword">on</span> emp</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  dbms_output.put_line(<span class="string">'Oracle：爷,您来了! 您随便插入数据吧!'</span>);</span><br><span class="line">  <span class="comment">-- 使用raise_application_error来抛出一个异常，其内有两个参数：</span></span><br><span class="line">  <span class="comment">-- 第一个参数：错误码，取值在-20000 ~ -20999之间即可。</span></span><br><span class="line">  <span class="comment">-- 第二个参数：错误的信息。</span></span><br><span class="line">  raise_application_error(-20000,'Oracle：哟，爷，您看，真不巧，没空间了！');</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line">/</span><br></pre></td></tr></table></figure></p>
<h1 id="MySql数据库"><a href="#MySql数据库" class="headerlink" title="MySql数据库"></a>MySql数据库</h1><p>　　MySQL是一个免费的中型的数据库，可以方便的建立数据库，很早以前MySQL 数据库就被Sun公司收购了，现在属于Oracle公司。</p>
<p>　　数据库结构图：</p>
<center><br><img src="/img/base/base003_03.png" alt=""><br></center>

<p>　　MySQL就是一个DBMS，其内部存在有多个数据库，每个数据库中又存放多张表，用户的数据是存放在表中的，用户通过DBMS来获取数据。</p>
<h2 id="数据库管理"><a href="#数据库管理" class="headerlink" title="数据库管理"></a>数据库管理</h2><p><br>　　范例1： 常用命令。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 登录mysql。语法：mysql –u用户名 –p密码</span></span><br><span class="line">mysql -uroot -pcxy</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建一个名为Test的数据库</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> <span class="keyword">Test</span>;</span><br><span class="line"><span class="comment">-- 若Test不存在，则执行创建操作，否则不执行任何操作</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> <span class="keyword">IF</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> <span class="keyword">Test</span>;</span><br><span class="line"><span class="comment">-- 指定数据库的编码</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> <span class="keyword">Test</span> <span class="built_in">CHARACTER</span> <span class="keyword">SET</span> utf8;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 列出服务器中所有数据库</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">databases</span>;</span><br><span class="line"><span class="comment">-- 删除数据库</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">database</span> <span class="keyword">test</span>;</span><br></pre></td></tr></table></figure></p>
<h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><center><br><img src="/img/base/base003_04.png" alt=""><br></center>

<h2 id="表管理"><a href="#表管理" class="headerlink" title="表管理"></a>表管理</h2><p><br>　　范例1： 常用命令。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span>  Person(</span><br><span class="line">   <span class="keyword">id</span>  <span class="built_in">int</span> ,</span><br><span class="line">   <span class="keyword">name</span>  <span class="built_in">varchar</span> (<span class="number">30</span>),</span><br><span class="line">   <span class="keyword">password</span> <span class="built_in">varchar</span>(<span class="number">30</span>) </span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 添加列</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> person <span class="keyword">ADD</span> birthday <span class="built_in">date</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看表中所有列</span></span><br><span class="line">DESC person;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 修改某一列</span></span><br><span class="line"><span class="comment">-- 修改时若表中已经存在数据，且新类型与原有类型不兼容，则无法修改成功。</span></span><br><span class="line"><span class="comment">-- 应该先将表中所有的数据删掉后，再修改列。</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> person <span class="keyword">MODIFY</span> birthday <span class="built_in">int</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除列</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> person <span class="keyword">DROP</span> birthday;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 修改表名</span></span><br><span class="line"><span class="keyword">rename</span> <span class="keyword">table</span> person <span class="keyword">to</span> student;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看当前数据库的所有表</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">tables</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 插入一行数据，相应的更新、删除也都和Oracle一样</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Person(<span class="keyword">id</span>,<span class="keyword">name</span>) <span class="keyword">VALUES</span>(<span class="number">1</span>,<span class="string">'张三'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Person(<span class="keyword">id</span>,<span class="keyword">name</span>) <span class="keyword">VALUES</span>(<span class="number">1</span>,<span class="string">'李四'</span>);</span><br></pre></td></tr></table></figure></p>
<p><br>　　范例2： 其它命令。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 使用auto_increment来设置id的编号自动增长。</span></span><br><span class="line"><span class="comment">-- auto_increment需要使用在主键上。</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span>  Person(</span><br><span class="line">   <span class="keyword">id</span>  <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">   <span class="keyword">name</span>  <span class="built_in">varchar</span> (<span class="number">30</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 限定查询</span></span><br><span class="line"><span class="comment">-- “limit 起点,个数”，起点的下标从0开始计算，起点可以省略，若省略则默认为0。</span></span><br><span class="line"><span class="keyword">SELECT</span>  *  <span class="keyword">FROM</span>  Person  <span class="keyword">LIMIT</span> <span class="number">0</span>,<span class="number">1</span></span><br></pre></td></tr></table></figure></p>

      
    </div>

    <footer class="post-footer">
      

      
      
    </footer>
  </article>


  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="c-base-004/"
           data-title="第四章 数据库" data-url="http://yoursite.com/c-base-004/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="键盘" />
          <p class="site-author-name" itemprop="name">键盘</p>
          <p class="site-description motion-element" itemprop="description">集大家之成，悟小家之道。</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">38</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">6</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="http://www.gov.cn/" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://weishu.me/" title="weishu" target="_blank">weishu</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://ryanhoo.github.io/" title="ryanhoo" target="_blank">ryanhoo</a>
                </li>
              
            </ul>
          </div>
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#概述"><span class="nav-number">1.</span> <span class="nav-text">概述</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Oracle数据库"><span class="nav-number">2.</span> <span class="nav-text">Oracle数据库</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#数据查询"><span class="nav-number">2.1.</span> <span class="nav-text">数据查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#简单查询"><span class="nav-number">2.1.1.</span> <span class="nav-text">简单查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#限定查询"><span class="nav-number">2.1.2.</span> <span class="nav-text">限定查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#单行函数"><span class="nav-number">2.1.3.</span> <span class="nav-text">单行函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#组函数"><span class="nav-number">2.1.4.</span> <span class="nav-text">组函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#多表查询"><span class="nav-number">2.1.5.</span> <span class="nav-text">多表查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#子查询"><span class="nav-number">2.1.6.</span> <span class="nav-text">子查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#集合运算"><span class="nav-number">2.1.7.</span> <span class="nav-text">集合运算</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据增删改"><span class="nav-number">2.2.</span> <span class="nav-text">数据增删改</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#对象管理"><span class="nav-number">2.3.</span> <span class="nav-text">对象管理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#表"><span class="nav-number">2.3.1.</span> <span class="nav-text">表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#视图"><span class="nav-number">2.3.2.</span> <span class="nav-text">视图</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#约束"><span class="nav-number">2.4.</span> <span class="nav-text">约束</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据库编程"><span class="nav-number">2.5.</span> <span class="nav-text">数据库编程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#PL-SQL基础"><span class="nav-number">2.5.1.</span> <span class="nav-text">PL/SQL基础</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#触发器"><span class="nav-number">2.5.2.</span> <span class="nav-text">触发器</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#MySql数据库"><span class="nav-number">3.</span> <span class="nav-text">MySql数据库</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#数据库管理"><span class="nav-number">3.1.</span> <span class="nav-text">数据库管理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据类型"><span class="nav-number">3.2.</span> <span class="nav-text">数据类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#表管理"><span class="nav-number">3.3.</span> <span class="nav-text">表管理</span></a></li></ol></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2014 - 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">键盘</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"cutler"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    <script src="/vendors/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  






  
  
  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("sGcgYofeKOFi2l1XvGrm0PcP-gzGzoHsz", "Sx0mWxj4pkXYm17zT0UnV5Ca");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

</body>
</html>
